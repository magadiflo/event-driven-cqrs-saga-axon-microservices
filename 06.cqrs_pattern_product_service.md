# Sección 07: Patrón CQRS en product-service

---

## Acepta Body HTTP Request

Vamos a crear una clase que nos permitirá mapear los valores enviados en el body de la petición.

````java

@Data
public class CreateProductRestModel {
    private String title;
    private BigDecimal price;
    private Integer quantity;
}
````

Ahora en el `ProductController` modificamos el endpoint `createProduct()` para mapear los valores enviados en el cuerpo
de la solicitud a una clase java.

````java

@RequiredArgsConstructor
@RestController
@RequestMapping(path = "/api/v1/products")
public class ProductController {

    private final Environment environment;

    /* otro endpoint */

    @PostMapping
    public String createProduct(@RequestBody CreateProductRestModel request) {
        return "HTTP POST Handled " + request.getTitle();
    }

    /* otros endpoints */
}
````

Para probar si los valores que estamos enviando se están mapeando a la clase java, vamos a realizar una petición
levantando los servicios en este orden:

1. Discover Server
2. Product Service
3. Gateway Server

Finalmente, realizamos la petición y vemos que todo está funcionando correctamente.

````bash
$ curl -v -X POST -H "Content-Type: application/json" -d "{\"title\": \"Samsung 20\", \"price\": 3500.50, \"quantity\": 10}" http://localhost:8080/api/v1/products
>
* upload completely sent off: 57 bytes
< HTTP/1.1 200 OK
< Content-Type: text/plain;charset=UTF-8
< Content-Length: 28
< Date: Tue, 07 Jan 2025 21:13:13 GMT
<
HTTP POST Handled Samsung 20
````

## Agrega dependencia de Axon Framework al Product Service

Antes de continuar debemos agregar a nuestro `product-service` la dependencia de `Axon Framework`.

````xml
<!-- https://mvnrepository.com/artifact/org.axonframework/axon-spring-boot-starter -->
<dependency>
    <groupId>org.axonframework</groupId>
    <artifactId>axon-spring-boot-starter</artifactId>
    <version>4.10.3</version>
</dependency>
````

#### Nota: Actualización de Axon Framework a la versión 4.7.0 (En mi caso es la 4.10)

> Desde que publicó este curso en video, `Axon Framework` se ha actualizado a una versión más reciente. Lamentablemente,
> hay algunos cambios importantes.
>
> Abra el siguiente enlace en una nueva ventana del
> navegador: [Actualización a la versión 4.7](https://docs.axoniq.io/axon-framework-reference/4.10/upgrading-to-4-7/).
> Manténgalo abierto mientras crea las primeras clases de su aplicación. Esta página contiene información sobre todos
> los cambios importantes y cómo resolverlos.

